<?xml version="1.0" encoding="UTF-8"?>
<galaxy xmlns="http://www.mulesource.org/schema/galaxy-plugins"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.mulesource.org/schema/galaxy-plugins http://www.mulesource.org/schema/galaxy-plugin/galaxy-plugins-1.0.xsd">

    <artifact-type>
        <name>Mule 1 Configurations</name>
        <description>Allows Mule 1 cofiguration files to be managed by Galaxy. Users can register, query and view Mule 1
            configuration files with this plugin.
        </description>
        <content-type>application/mule+xml</content-type>
        <!--<small-icon>META-INF/images/mule1_16x16.png</small-icon>-->
        <!--<large-icon>META-INF/images/mule1_32x32.png</large-icon>-->
        <namespace>
            <local-name>mule-configuration</local-name>
        </namespace>
        <indexes>
            <index>
                <description>Mule Configuration Description</description>
                <indexer>xpath</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                    <property>mule.description</property>
                    <expression><![CDATA[/mule-configuration/description]]></expression>
                </configuration>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
            <index>
                <description>Mule Server Id</description>
                <indexer>xpath</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                  <property>mule.server.id</property>
                  <expression><![CDATA[/mule-configuration/@id]]>
                </expression></configuration>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
            <index>
                <description>Mule Endpoints</description>
                <indexer>xquery</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                  <property>mule.endpoint</property>
                  <expression><![CDATA[
declare variable $document external;
<values> {
for $e in $document//global-endpoints/endpoint
    return <value>{data($e/@name)}</value>
}</values>
                ]]>
                </expression></configuration>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
            <index>
                <description>Mule Transformers</description>
                <indexer>xquery</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                 <property>mule.transformer</property>
                 <expression><![CDATA[
declare variable $document external;
<values> {
for $e in $document/transformers/transformer
    return <value>{data($e/@name)}</value>
} </values>
                ]]>
                </expression></configuration>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
            <index>
                <description>Mule Models</description>
                <indexer>xquery</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                  <property>mule.model</property>
                  <expression><![CDATA[
declare variable $document external;
<values> {
   for $e in $document//model
     return <value>{data($e/@name)}</value>
   } </values>
                   ]]>
                </expression></configuration>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
            <index>
                <description>Mule Descriptors</description>
                <indexer>xquery</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                  <property>mule.descriptor</property>
                  <expression><![CDATA[
declare variable $document external;
<values> {
   for $e in $document//mule-descriptor
     return <value>{data($e/@name)}</value>
   } </values>
                   ]]>
                </expression></configuration>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
        </indexes>
        <views>
            <view>
                <column>
                    <name>Descriptors</name>
                    <expression>artifact.hasProperty("mule.descriptor") ? artifact.getProperty("mule.descriptor").size() : "0" ;</expression>
                </column>
                <column>
                    <name>Transformers</name>
                    <expression>artifact.hasProperty("mule.transformer") ? artifact.getProperty("mule.transformer").size() : "0" ;</expression>
                </column>
                <column>
                    <name>Endpoints</name>
                    <expression>artifact.hasProperty("mule.endpoint") ? artifact.getProperty("mule.endpoint").size() : "0" ;</expression>
                </column>
                <column>
                    <name>Models</name>
                    <expression>artifact.hasProperty("mule.model") ? artifact.getProperty("mule.model").size() : "0" ;</expression>
                </column>
            </view>
        </views>
    </artifact-type>
    
    <policies>
        <artifact-policy>
            <name>Require SSL</name>
            <class>org.mule.galaxy.mule1.policy.RequireSSLPolicy</class>
            <description>Enforces the use of ssl on http and tcp endpoints</description>
        </artifact-policy>
        <artifact-policy>
            <name>Require JMX</name>
            <class>org.mule.galaxy.mule1.policy.RequireJMXPolicy</class>
            <description>Enforces that JMX is configured.</description>
        </artifact-policy>
        <artifact-policy>
            <name>Require JMX</name>
            <class>org.mule.galaxy.mule1.policy.RequireNoClientRemotingPolicy</class>
            <description>Requires that Client Remote Dispatcher support is not enabled.</description>
        </artifact-policy>
        <artifact-policy>
            <name>Require Global Endpoints</name>
            <class>org.mule.galaxy.mule1.policy.RequireGlobalEndpointsPolicy</class>
            <description>Requires all All Endpoints are defined as top level Endpoints.</description>
        </artifact-policy>
    </policies>

</galaxy>