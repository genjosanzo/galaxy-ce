<?xml version="1.0" encoding="UTF-8"?>
<galaxy xmlns="http://www.mulesource.org/schema/galaxy-plugins"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.mulesource.org/schema/galaxy-plugins http://www.mulesource.org/schema/galaxy-plugin/galaxy-plugins-1.0.xsd">
    <artifact-type>
        <name>Mule 2 Configurations</name>
        <description>Allows Mule 2 cofiguration files to be managed by Galaxy. Users can register, query and view Mule 2
            configuration files with this plugin.
        </description>
        <content-type>application/mule2+xml</content-type>
        <!--<small-icon>META-INF/images/mule2_16x16.png</small-icon>-->
        <!--<large-icon>META-INF/images/mule2_32x32.png</large-icon>-->
        <!--  -->
        <namespace>
            <local-name>mule</local-name>
            <uri>http://www.mulesource.org/schema/mule/core</uri>
        </namespace>
        <namespace>
            <local-name>mule</local-name>
            <uri>http://www.mulesource.org/schema/mule/core/2.2</uri>
        </namespace>
        <namespace>
            <local-name>mule</local-name>
            <uri>http://www.mulesource.org/schema/mule/core/2.1</uri>
        </namespace>
        <namespace>
            <local-name>mule</local-name>
            <uri>http://www.mulesource.org/schema/mule/core/2.0</uri>
        </namespace>
        <indexes>
            <index>
                <description>Mule 2 Description</description>
                <indexer>xpath</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                  <property>mule.description</property>
                  <expression><![CDATA[/*[local-name()='${namespace.local-name}']/*[local-name()='description']]]></expression>
                </configuration>
            </index>
            <!--<index>-->
                <!--<property>mule.model.description</property>-->
                <!--<description>Mule 2 Model Description</description>-->
                <!--<description>The description for a Mule Model in the configuration</description>-->
                <!--<indexer>xpath</indexer>-->
                <!--<search-input-type>java.lang.String</search-input-type>-->
                <!--<expression><![CDATA[/*[local-name()='${namespace.local-name}' and namespace-uri()='${namespace.uri}']/*[local-name()='model/description']-->
                <!--]]></expression>-->
            <!--</index>-->
            <!--<index>-->
                <!--<property>mule.service.description</property>-->
                <!--<description>Mule 2 Service Description</description>-->
                <!--<description>The description for a Mule Service in the configuration</description>-->
                <!--<indexer>xpath</indexer>-->
                <!--<search-input-type>java.lang.String</search-input-type>-->
                <!--<expression><![CDATA[/*[local-name()='${namespace.local-name}' and namespace-uri()='${namespace.uri}']//*[local-name()='service']-->
                <!--]]></expression>-->
            <!--</index>-->
            <index>
                <description>Mule 2 Cluster Id</description>
                <indexer>xpath</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                  <property>mule.cluster.id</property>
                  <expression><![CDATA[/*/*[local-name()='configuration']/@clusterId]]></expression>
                </configuration>
            </index>
            <index>
                <description>Mule 2 Domain Id</description>
                <indexer>xpath</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                  <property>mule.domain.id</property>
                  <expression><![CDATA[/*/*[local-name()='configuration']/@domainId]]></expression>
                </configuration>
            </index>
            <index>
                <description>Mule 2 Services</description>
                <indexer>xquery</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                  <property>mule.service</property>
                  <expression><![CDATA[
declare variable $document external;
<values> {
    for $svc in $document//*[local-name()='service']
        return <value>{data($svc/@name)}</value>
} </values>
]]></expression></configuration>
            </index>
            <index>
                <description>Mule 2 Global Endpoints</description>
                <indexer>xquery</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                  <property>mule.endpoint</property>
                  <expression><![CDATA[
declare variable $document external;
<values> {
    for $svc in $document/*[local-name()='mule']/*[local-name()='endpoint']
        return <value>{data($svc/@name)}</value>
} </values>
]]>
                </expression></configuration>
            </index>
            <index>
                <description>Mule 2 Models</description>
                <indexer>xquery</indexer>
                <search-input-type>java.lang.String</search-input-type>
                <configuration>
                  <property>mule.model</property>
                  <expression><![CDATA[
declare variable $document external;
<values> {
    for $svc in $document/*[local-name()='mule']/*[local-name()='model']
        return <value>{data($svc/@name)}</value>
} </values>
]]>
                </expression></configuration>
            </index>
        </indexes>
        <views>
            <view>
                <column>
                    <name>Services</name>
                    <expression>item.hasProperty("mule.service") ? item.getProperty("mule.service").size() : "0" ;</expression>
                </column>
                <column>
                    <name>Endpoints</name>
                    <expression>item.hasProperty("mule.endpoint") ? item.getProperty("mule.endpoint").size() : "0" ;</expression>
                </column>
                <column>
                    <name>Models</name>
                    <expression>item.hasProperty("mule.model") ? item.getProperty("mule.model").size() : "0" ;</expression>
                </column>
            </view>
        </views>
    </artifact-type>
    
    <policies>
        <artifact-policy>
            <name>Require SSL</name>
            <class>org.mule.galaxy.mule2.policy.RequireSSLPolicy</class>
            <description>Enforces the use of ssl on http and tcp endpoints</description>
        </artifact-policy>
        <artifact-policy>
            <name>Require JMX</name>
            <class>org.mule.galaxy.mule2.policy.RequireNoClientRemotingPolicy</class>
            <description>Requires that Client Remote Dispatcher support is not enabled.</description>
        </artifact-policy>
        <artifact-policy>
            <name>Require Global Endpoints</name>
            <class>org.mule.galaxy.mule2.policy.RequireGlobalEndpointsPolicy</class>
            <description>Requires all All Endpoints are defined as top level Endpoints.</description>
        </artifact-policy>
    </policies>
 </galaxy>