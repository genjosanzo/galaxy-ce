<?xml version="1.0" encoding="UTF-8"?>
<galaxy-plugins xmlns="http://www.mulesource.org/schema/galaxy-plugin"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xsi:schemaLocation="
       http://www.mulesource.org/schema/galaxy-plugin http://www.mulesource.org/schema/galaxy-plugin/galaxy-plugin-1.0.xsd">

    <galaxy-plugin>
        <name>WSDL Documents</name>
        <description>Allows WSDL Documents to be managed by Galaxy. Users can register, query and view WSDL documents with this plugin.
        </description>
        <content-type>application/wsdl+xml</content-type>
        <!--<small-icon>META-INF/images/wsdl_16x16.png</small-icon>-->
        <!--<large-icon>META-INF/images/wsdl_32x32.png</large-icon>-->
        <namespace>
            <local-name>definitions</local-name>
            <uri>http://schemas.xmlsoap.org/wsdl/</uri>
        </namespace>
        <indexes>
            <index>
                <field-name>wsdl.service</field-name>
                <display-name>WSDL Service</display-name>
                <description>WSDL Service Definitions</description>
                <language>XQUERY</language>
                <search-input-type>java.lang.String</search-input-type>
                <expression><![CDATA[
                    declare namespace wsdl="${namespace.uri}";
                    declare variable $document external;
                    <values> {
                        for $svc in $document//wsdl:service
                        let $ns := $document/wsdl:definition/@targetNamespace
                        return <value>{data($svc/@name)}</value>
                    } </values>
                    ]]>
                </expression>
            </index>
            <index>
                <field-name>wsdl.endpoint</field-name>
                <display-name>WSDL Endpoints</display-name>
                <description>WSDL Endpoint Definitions</description>
                <language>XQUERY</language>
                <search-input-type>java.lang.String</search-input-type>
                <expression><![CDATA[
                    declare namespace wsdl="${namespace.uri}";
                    declare variable $document external;
                    <values> {
                        for $ep in $document//wsdl:service/wsdl:port
                        let $ns := $document/wsdl:definition/@targetNamespace
                        return <value>{data($ep/@name)}</value>
                    } </values>
                    ]]>
                </expression>
            </index>
            <index>
                <field-name>wsdl.binding</field-name>
                <display-name>WSDL Bindings</display-name>
                <description>WSDL Binding Definitions</description>
                <language>XQUERY</language>
                <search-input-type>java.lang.String</search-input-type>
                <expression><![CDATA[
                    declare namespace wsdl="${namespace.uri}";
                    declare variable $document external;
                    <values> {
                        for $b in $document//wsdl:binding
                        let $ns := $document/wsdl:definition/@targetNamespace
                        return <value>{data($b/@name)}</value>
                    } </values>
                    ]]>
                </expression>
            </index>
            <index>
                <field-name>wsdl.portType</field-name>
                <display-name>WSDL PortTypes</display-name>
                <description>WSDL PortType Definitions</description>
                <language>XQUERY</language>
                <search-input-type>java.lang.String</search-input-type>
                <expression><![CDATA[
                    declare namespace wsdl="${namespace.uri}";
                    declare variable $document external;
                    <values> {
                        for $pt in $document//wsdl:portType
                        let $ns := $document/wsdl:definition/@targetNamespace
                        return <value>{data($pt/@name)}</value>
                    } </values>
                    ]]>
                </expression>
            </index>
            <index>
                <field-name>wsdl.targetNamespace</field-name>
                <display-name>WSDL Target Namespace</display-name>
                <description>WSDL Target Namespace Definition</description>
                <language>XPATH</language>
                <search-input-type>java.lang.String</search-input-type>
                <expression><![CDATA[/*/@targetNamespace]]>
                </expression>
            </index>
        </indexes>
        <views>
            <view>
                <column>
                    <name>Descriptors</name>
                    <index-field>mule.descriptor</index-field>
                </column>
                <column>
                    <name>Transformers</name>
                    <index-field>mule.transformer</index-field>
                </column>
                <column>
                    <name>Endpoints</name>
                    <index-field>mule.endpoint</index-field>
                </column>
                <column>
                    <name>Models</name>
                    <index-field>mule.model</index-field>
                </column>
            </view>
        </views>
        <policies>
            <policy>
                <name>Require SSL</name>
                <class>org.mule.galaxy.policy.mule.RequireSSLPolicy</class>
                <description>Enforces the use of ssl on http and tcp endpoints</description>
            </policy>
        </policies>
    </galaxy-plugin>
</galaxy-plugins>