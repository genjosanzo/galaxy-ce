<?xml version="1.0" encoding="UTF-8"?>
<galaxy-plugins xmlns="http://www.mulesource.org/schema/galaxy-plugin"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

                xsi:schemaLocation="
       http://www.mulesource.org/schema/galaxy-plugin http://www.mulesource.org/schema/galaxy-plugin/galaxy-plugin-1.0.xsd">

    <galaxy-plugin>
        <name>Mule 1 Configurations</name>
        <description>Allows Mule 1 cofiguration files to be managed by Galaxy. Users can register, query and view Mule 1
            configuration files with this plugin.
        </description>
        <content-type>application/mule+xml</content-type>
        <!--<small-icon>META-INF/images/mule1_16x16.png</small-icon>-->
        <!--<large-icon>META-INF/images/mule1_32x32.png</large-icon>-->
        <namespace>
            <local-name>mule-configuration</local-name>
        </namespace>
        <indexes>
            <index>
                <field-name>mule.description</field-name>
                <display-name>Mule Description</display-name>
                <description>The description for the Mule configuration</description>
                <language>XPATH</language>
                <search-input-type>java.lang.String</search-input-type>
                <expression><![CDATA[/mule-configuration/description]]></expression>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
            <index>
                <field-name>mule.server.id</field-name>
                <display-name>Mule Server Id</display-name>
                <description>Indexes &lt;mule-configuration id&gt; attribute</description>
                <language>XPATH</language>
                <search-input-type>java.lang.String</search-input-type>
                <expression><![CDATA[/mule-configuration/@id]]>
                </expression>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
            <index>
                <field-name>mule.endpoint</field-name>
                <display-name>Mule Endpoints</display-name>
                <description>Indexes Mule 1 Global Endpoints</description>
                <language>XQUERY</language>
                <search-input-type>java.lang.String</search-input-type>
                <expression><![CDATA[
declare variable $document external;
<values> {
for $e in $document//global-endpoints/endpoint
    return <value>{data($e/@name)}</value>
}</values>
                ]]>
                </expression>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
            <index>
                <field-name>mule.transformer</field-name>
                <display-name>Mule Transformers</display-name>
                <description>Indexes Mule 1 Transformers</description>
                <language>XQUERY</language>
                <search-input-type>java.lang.String</search-input-type>
                <expression><![CDATA[
declare variable $document external;
<values> {
for $e in $document/transformers/transformer
    return <value>{data($e/@name)}</value>
} </values>
                ]]>
                </expression>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
            <index>
                <field-name>mule.model</field-name>
                <display-name>Mule Models</display-name>
                <description>Indexes Mule 1 Models</description>
                <language>XQUERY</language>
                <search-input-type>java.lang.String</search-input-type>
                <expression><![CDATA[
declare variable $document external;
<values> {
   for $e in $document//model
     return <value>{data($e/@name)}</value>
   } </values>
                   ]]>
                </expression>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
            <index>
                <field-name>mule.descriptor</field-name>
                <display-name>Mule Descriptors</display-name>
                <description>Indexes Mule 1 service descriptors</description>
                <language>XQUERY</language>
                <search-input-type>java.lang.String</search-input-type>
                <expression><![CDATA[
declare variable $document external;
<values> {
   for $e in $document//mule-descriptor
     return <value>{data($e/@name)}</value>
   } </values>
                   ]]>
                </expression>
                <namespace>
                    <local-name>mule-configuration</local-name>
                </namespace>
            </index>
        </indexes>
        <views>
            <view>
                <column>
                    <name>Descriptors</name>
                    <expression>artifact.hasProperty("mule.descriptor") ? artifact.getProperty("mule.descriptor").size() : "0" ;</expression>
                </column>
                <column>
                    <name>Transformers</name>
                    <expression>artifact.hasProperty("mule.transformer") ? artifact.getProperty("mule.transformer").size() : "0" ;</expression>
                </column>
                <column>
                    <name>Endpoints</name>
                    <expression>artifact.hasProperty("mule.endpoint") ? artifact.getProperty("mule.endpoint").size() : "0" ;</expression>
                </column>
                <column>
                    <name>Models</name>
                    <expression>artifact.hasProperty("mule.model") ? artifact.getProperty("mule.model").size() : "0" ;</expression>
                </column>
            </view>
        </views>
        <policies>
            <policy>
                <name>Require SSL</name>
                <class>org.mule.galaxy.mule1.policy.RequireSslPolicy</class>
                <description>Enforces the use of ssl on http and tcp endpoints</description>
            </policy>
        </policies>
    </galaxy-plugin>
</galaxy-plugins>